openapi: 3.0.0
info:
  title: Dokumentasi API Infotiket.in
  description: Infotiket.in adalah website penyedia pemesanan tiket pesawat terbang!
  version: 1.0.0
  contact:
    email: Infotiket.in@gmail.com
servers:
  - url: http://localhost:3000

paths:
  /register:
    post:
      tags:
        - "Mendaftar"
      summary: Mendaftarkan Pengguna Baru
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Mendaftar"

      responses:
        201:
          description: Sukses
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Akun berhasil dibuat. Silahkan periksa email Anda untuk verifikasi!
                  data:
                    type: object
                    properties:
                      id:
                        type: number
                        example: 1
                      first_name:
                        type: string
                        example: BE3
                      last_name:
                        type: string
                        example: Infotiket.in
                      email:
                        type: string
                        example: infotiketin@gmail.com
                      is_verified:
                        type: boolean
                        example: false
                      image_url:
                        type: string
                        example: null
                      role:
                        type: string
                        example: user

        400:
          description: Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Email sudah digunakan sebelumnya!
                  data:
                    type: string
                    example: null

  /login:
    post:
      tags:
        - "Masuk"
      summary: Login dengan email dan kata sandi
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Login"

      responses:
        200:
          description: Sukses
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Anda telah berhasil masuk!
                  data:
                    type: object
                    properties:
                      id:
                        type: number
                        example: 1
                      first_name:
                        type: string
                        example: BE3
                      last_name:
                        type: string
                        example: Infotiket.in
                      email:
                        type: string
                        example: infotiketin@gmail.com
                      is_verified:
                        type: boolean
                        example: false
                      image_url:
                        type: string
                        example: null
                      role:
                        type: string
                        example: user
                      token:
                        type: string
                        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MywiaWF0IjoxNzE2NzI1ODMyfQ.b19b_5Os8Tbj_ltRoGyOkD8KfxZ-S-12312scwasr23
        400:
          description: Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Email atau kata sandi tidak valid!
                  data:
                    type: string
                    example: null

  /verifikasi:
    get:
      tags:
        - "Verifikasi Email"
      summary: "Verifikasi Email"
      parameters:
        - schema:
            type: string
          name: token
          in: "query"
          description: "Token autentikasi"
          required: true

      responses:
        200:
          description: Sukses
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Verifikasi Sukses
                  data:
                    type: string
                    example: null

        400:
          description: Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Gagal diverifikasi
                  data:
                    type: string
                    example: null

  /:
    get:
      tags:
        - "Selamat Datang"
      summary: Selamat datang di Infotiket.in
      security:
        - BearerAuth: []

      responses:
        200:
          description: Sukses
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Selamat Datang di website Infotiket.in!
                  data:
                    type: object
                    properties:
                      id:
                        type: number
                        example: 1
                      first_name:
                        type: string
                        example: BE3
                      last_name:
                        type: string
                        example: Infotiket.in
                      email:
                        type: string
                        example: infotiketin@gmail.com
                      is_verified:
                        type: boolean
                        example: false
                      image_url:
                        type: string
                        example: null
                      role:
                        type: string
                        example: user

        400:
          description: Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Tidak ada token!
                  data:
                    type: string
                    example: null

  /forgot-password:
    post:
      tags:
        - "Lupa kata sandi"
      summary: Lupa sandi dengan email
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  example: infotiketin@gmail.com

      responses:
        200:
          description: Sukses
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Silahkan periksa email Anda untuk atur ulang kata sandi!
                  data:
                    type: string
                    example: null

        400:
          description: Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Pengguna tidak ditemukan!
                  data:
                    type: string
                    example: null

  /reset-password:
    post:
      tags:
        - "Setel ulang kata sandi"
      summary: "Setel ulang kata sandi"
      parameters:
        - schema:
            type: string
          name: token
          in: "query"
          description: "Token autentikasi"
          required: true
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                password:
                  type: string
                  example: tes
                confirmPassword:
                  type: string
                  example: tes

      responses:
        200:
          description: Sukses
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Berhasil mengubah kata sandi!
                  data:
                    type: string
                    example: null

        400:
          description: Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Token tidak valid atau sudah kedaluwarsa!
                  data:
                    type: string
                    example: null

  /api/v1/profile:
    get:
      tags:
        - "Dapatkan Profil"
      summary: "Profil"
      security:
        - BearerAuth: []

      responses:
        200:
          description: Sukses
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Berhasil mengambil data
                  data:
                    type: object
                    properties:
                      id:
                        type: number
                        example: 1
                      first_name:
                        type: string
                        example: BE3
                      last_name:
                        type: string
                        example: Infotiket.in
                      email:
                        type: string
                        example: infotiketin@gmail.com
                      is_verified:
                        type: boolean
                        example: false
                      image_url:
                        type: string
                        example: null
                      role:
                        type: string
                        example: user

        400:
          description: Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Tidak ada token!
                  data:
                    type: string
                    example: null

    put:
      tags:
        - "put /profile:"
      summary: "Profile"
      security:
        - BearerAuth: []
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                first_name:
                  type: string
                  example: x
                last_name:
                  type: string
                  example: x
                password:
                  type: string
                  example: x
                confirmPassword:
                  type: string
                  example: x
                gambar_url:
                  type: string
                  format: binary
      responses:
        200:
          description: Sukses
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Berhasil memperbaharui profil
                  data:
                    type: object
                    properties:
                      id:
                        type: number
                        example: 1
                      first_name:
                        type: string
                        example: BE3
                      last_name:
                        type: string
                        example: Infotiket.in
                      email:
                        type: string
                        example: infotiketin@gmail.com
                      is_verified:
                        type: boolean
                        example: true
                      image_url:
                        type: string
                        example: https://ik.imagekit.io/gis/1716888675180_3hjYL9i1u.jpg
                      role:
                        type: string
                        example: user

        400:
          description: Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Kata sandi tidak cocok!
                  data:
                    type: string
                    example: null

        500:
          description: Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Gagal mengunggah gambar!
                  data:
                    type: string
                    example: null

  /api/v1/airports:
    get:
      tags:
        - "Bandara"
      summary: Daftar Semua Data Bandara
      responses:
        201:
          description: sukses
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  message:
                    type: string
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                        name_airport:
                          type: string
                        city:
                          type: string
                        province:
                          type: string
                        time_zone:
                          type: string
                        iata_code:
                          type: string
                        from_flights:
                          type: array
                        to_flights:
                          type: array

              examples:
                responses:
                  value:
                    status: true
                    message: Berhasil menampilkan semua data Airports
                    data:
                      - id: 1
                        name_airport: APT Pranoto Airport
                        city: Samarinda
                        province: Kalimantan Timur
                        time_zone: UTC+8
                        iata_code: AAP
                        from_flights: []
                        to_flights: []
                      - id: 2
                        name_airport: Abdul Rachman Saleh
                        city: Malang
                        province: Jawa Timur
                        time_zone: UTC+7
                        iata_code: MLG
                        from_flights: []
                        to_flights: []

        404:
          description: Halaman Tidak Ditemukan 404
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Halaman Tidak Ditemukan 404
                  err:
                    type: string
                    example: Cannot find /api/v1/airportss
                  data:
                    type: string
                    example: null

  /api/v1/airport/{id}:
    parameters:
      - schema:
          type: integer
        name: id
        in: path
        required: true

    get:
      tags:
        - "Bandara"
      summary: Daftar Data Bandara ID

      responses:
        201:
          description: sukses
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: true
                  message:
                    type: string
                    example: Berhasil menampilkan semua data Airports
                  data:
                    allOf:
                      - $ref: "#/components/schemas/Bandara"

        404:
          description: Halaman Tidak Ditemukan 404
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Data Airport tidak ditemukan!
                  data:
                    type: string
                    example: null

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    Mendaftar:
      type: object
      properties:
        first_name:
          type: string
          example: BE3
        last_name:
          type: string
          example: Infotiket.in
        email:
          type: string
          example: infotiketin@gmail.com
        password:
          type: string
          example: password123
        confirmPassword:
          type: string
          example: password123
    Login:
      type: object
      properties:
        email:
          type: string
          example: infotiketin@gmail.com
        password:
          type: string
          example: password123
    Bandara:
      type: object
      properties:
        id:
          type: integer
          example: 1
        name_airport:
          type: string
          example: APT Pranoto Airport
        city:
          type: string
          example: Samarinda
        province:
          type: string
          example: Kalimantan Timur
        time_zone:
          type: string
          example: UTC+8
        iata_code:
          type: string
          example: AAP
        from_flights:
          type: array
          example: []
        to_flights:
          type: array
          example: []
